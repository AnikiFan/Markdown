# 计算机组成原理

## 运算方法和运算部件

### 数制

常用的数制有：十进制，二进制，八进制和十六进制。

常用的转换方式有：

1. 十进制转二进制：整数部分采用逆向取余数的方式，小数部分则是每次乘2按顺序取个位。计算小数部分时，可能会出现无限循环，假设以及按照该方法取出了k位小数，那么这k位就已经确定下来了，且是准确的，误差只可能发生在k+1位小数及以后，所以误差小于$2^{-k}$。
2. 二进制转十进制：采用加权展开的方式
3. 二进制与八进制或十六进制之间的转换：一位八进制数对应3位二进制数；一位十六进制数对应4位二进制数。在转换时，按需在前端或末端添加0，转换结束后删去前端或后端的0。

### 编码

在计算机中存储的数据对应着某个数，我们将这个数成为“真值”，在这里我们规定真值必须要有正负之分。特别地，我们要考虑“正零”和“负零”。

#### 十进制数的编码与运算

计算机中的数据都以二进制存储，只由01组成。所以如果想要在计算机中直接存储十进制数，需要以编码的方式，也就是用特定的二进制组合来表示一个十进制数。

表示方案主要可以分为有权码和无权码

##### 有权码

在这类方案中，每个位置上的01值都对应这十进制中的某个值，称为权重，将每一位1所对应的权重相加，便可以得到整个组合所代表的十进制数。

常用的有权码是BCD码，也称8421码，因为该码共4位，从左到右对应的权重为8，4，2，1。也就是该编码方式和十进制数转换为2进制后的表示方式一致。

但是这种编码方式只考虑了0-9，使得当两个编码进行相加时，如果某位上的和大于9，则需要在该位上在加上6，也就是BCD码0110，以产生正确的进位。

##### 无权码

余3码是在0-9的4位二进制表示的基础上加上0011，即3，得到的编码。在使用余3码进行加法运算时，如果没有产生进位，则需要在该位减去0011，使得该位
符合余3码的规则（+3+3-3=+3）；如果进位，则需要再加上0011，使得该位符合余3码的规则（+3+3-6+3=+3，进位扣除了6）.

格雷码的特点是任何两个响铃编码只有1个二进制位不同。

### 计算机中的二进制数据表示及运算

在机器中并没有正负号，只能用01来表示正负，不同的表示方法产生了不同的编码方式。我们称计算机中用01串来表示的带符号的二进制数为”机器数“。
对于同一个真值$X$，它所对应的机器数可以由原码，补码或反码来表示。

要注意的是，对于任意一个真值，它的机器数是由表示实际在计算机中存储的编码，以及编码规则所决定的，所以机器数可能会和真值有偏差。真值的取值范围是实数，而机器数的取值范围则是特定编码格式所能表示的有限多个数。

因此，虽然机器数仍是个二进制——有小数点、由01组成，但是我们其中的01与其代表数值，更多的是一种符号含义，例如，我们规定第一位是符号位，为1代表真值为正，否则为负。我们只是在转换和运算时将其视为二进制数值。

接下来定义的各种编码，实际上是定义了两个函数$f,g$：

给定真值 $X$，由 $f$转换为能在计算机中直接存储和运算的二进制数，这个二进制数就是机器数，$g$则负责将这个机器数转换为实际在计算机中存储的01串（例如去除小数点等）。

二进制数可以分为整数，定点小数（小数点前只有1位的小数），和浮点小数（小数点前位数不定的小数）。这几种类型有各自的编码，即使共用一套编码规则，
具体的转换函数也略有差别。

#### 定点小数编码

在定点小数编码中，机器数对应的机器数也是一个小数，且规定小数点前为符号位。

\[
[X]_{原} = \begin{cases}
X&，X为正\\
1-X&，X为负\\
\end{cases}    
\]
\[
[X]_{补} = \begin{cases}
X&，X为正\\
2+X \mod 2&，X为负\\
\end{cases}    
\]
$[Y]_{补}$形成$[-Y]_{补}$的方法是从左到右依次取反，直到最后一个1为止（不包括对最后一个1取反）。
\[
[X]_{反} = \begin{cases}
X&，X为正\\
2-2^{-n}+X &，X为负\\
\end{cases}    
\]
对于正真值，三种编码方式得到的机器数相同。对于负真值，首先我们容易得到原码的表示方式；我们在原码的基础上保持符号位不变，数值位取反即可得到反码；保持符号位不变，数值部分从左到右依次取反，直到最后一个1为止（不包括），即可得到补码。

原码和补码在运算时时遵循模2，而反码运算时遵循模 $2-2^n$，其中 $n$为精度，也就是说，当最高位产生进位时，要在最低位加1.

如果机器数数值部分有n位，则原码，补码，反码能表达的正真值范围均为 $[0,1-2^n]$。对于负真值范围，原码和反码为$[-(1-2^n),0]$，补码则是 $[-1,0]$。

#### 整数编码

对于有着 $n$位数值的真值，
\[
[X]_{原} = \begin{cases}
X&，X为正\\
2^n-X&，X为负\\
\end{cases}    
\]
\[
[X]_{补} = \begin{cases}
X&，X为正\\
2^{n+1}+X&，X为负\\
\end{cases}    
\]
\[
[X]_{反} = \begin{cases}
X&，X为正\\
2^{n+1}-1+X &，X为负\\
\end{cases}    
\]

#### 浮点数编码

浮点数编码中使用了一种特别的整数编码——移码，只需把补码的符号码取反即可得到。因此，当移码全为0时，其真值为最小负值。移码进行加减法运算时，需要对结果的符号为取反。

有
\[[X\pm Y]_{移}=[X]_{移}+[\pm Y]_{补}\]